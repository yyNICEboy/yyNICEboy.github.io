
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>è®ºæ–‡è‡ªæ£€ä»»åŠ¡æ¸…å•</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .checkbox { display: flex; align-items: center; }
    .checkbox input { margin-right: 10px; }
    .completed { text-decoration: line-through; color: gray; }
    #badges span { margin-right: 10px; background-color: #e0e0e0; padding: 5px 10px; border-radius: 5px; }
    #progress-bar {
      width: 100%;
      background-color: #e0e0e0;
      border-radius: 5px;
      margin: 20px 0;
    }
    #progress {
      width: 0%;
      height: 20px;
      background-color: #76c7c0;
      border-radius: 5px;
      text-align: center;
      color: white;
      line-height: 20px;
    }
  </style>
</head>
<body>
  <h1>è®ºæ–‡è‡ªæ£€ä»»åŠ¡æ¸…å•</h1>
<h2>ä»»åŠ¡æ€»è§ˆ</h2>
<ul>
<li><strong>æ€»ç§¯åˆ†</strong>ï¼š<span id="total-points">0</span></li>
<li><strong>å·²è§£é”å¾½ç« </strong>ï¼š<span id="badges">æ— </span></li>
</ul>
<h2>ä»»åŠ¡åˆ—è¡¨</h2>
<h3>ğŸ“„ æ ‡é¢˜ä¸å°é¢</h3>
<ul>
<li id="task-title"><input type="checkbox" id="cbx_0"><label for="cbx_0"></label><strong>æ£€æŸ¥æ ‡é¢˜</strong>ï¼šç¡®ä¿æ ‡é¢˜ç®€æ´æ˜äº†ã€‚ <!-- points:10 --></li>
<li id="task-cover"><input type="checkbox" id="cbx_1"><label for="cbx_1"></label><strong>å°é¢æ ¼å¼</strong>ï¼šå°é¢ç¬¦åˆè¦æ±‚çš„æ ¼å¼ã€‚ <!-- points:10 --></li>
<li><strong>å¾½ç« å¥–åŠ±</strong>ï¼šå®Œæˆæ‰€æœ‰ä»»åŠ¡å¯è·å¾—â€œæ ¼å¼è¾¾äººâ€å¾½ç« ã€‚</li>
</ul>
<h3>ğŸ“ æ‘˜è¦</h3>
<ul>
<li id="task-abstract-content"><input type="checkbox" id="cbx_2"><label for="cbx_2"></label><strong>å†…å®¹å®Œæ•´</strong>ï¼šæ‘˜è¦åŒ…å«ç ”ç©¶ç›®çš„ã€æ–¹æ³•ã€ç»“æœå’Œç»“è®ºã€‚ <!-- points:15 --></li>
<li id="task-abstract-length"><input type="checkbox" id="cbx_3"><label for="cbx_3"></label><strong>å­—æ•°ç¬¦åˆ</strong>ï¼šæ‘˜è¦å­—æ•°åœ¨è§„å®šèŒƒå›´å†…ã€‚ <!-- points:10 --></li>
<li><strong>å¾½ç« å¥–åŠ±</strong>ï¼šå®Œæˆæ‰€æœ‰ä»»åŠ¡å¯è·å¾—â€œæ‘˜è¦é«˜æ‰‹â€å¾½ç« ã€‚</li>
</ul>
<!-- æ·»åŠ æ›´å¤šä»»åŠ¡éƒ¨åˆ† -->
  
  <div id="progress-bar">
    <div id="progress">0%</div>
  </div>
  
  <script>
    // è·å–æ‰€æœ‰å¤é€‰æ¡†
    const checkboxes = document.querySelectorAll('input[type="checkbox"]');
    const totalPointsEl = document.getElementById('total-points');
    const badgesEl = document.getElementById('badges');
    const progressEl = document.getElementById('progress');

    // ç§¯åˆ†å’Œå¾½ç« æ•°æ®
    const badges = {
      'æ ¼å¼è¾¾äºº': { required: 20 },
      'æ‘˜è¦é«˜æ‰‹': { required: 25 },
      // æ·»åŠ æ›´å¤šå¾½ç« 
    };
    let totalPoints = 0;
    let unlockedBadges = [];

    // åˆå§‹åŒ–ï¼šåŠ è½½æ•°æ®
    window.onload = () => {
      // åŠ è½½æ€»ç§¯åˆ†
      if (localStorage.getItem('totalPoints')) {
        totalPoints = parseInt(localStorage.getItem('totalPoints'));
        totalPointsEl.textContent = totalPoints;
      }

      // åŠ è½½å·²è§£é”çš„å¾½ç« 
      if (localStorage.getItem('unlockedBadges')) {
        unlockedBadges = JSON.parse(localStorage.getItem('unlockedBadges'));
        updateBadges();
      }

      // åˆå§‹åŒ–å¤é€‰æ¡†çŠ¶æ€
      checkboxes.forEach(cb => {
        const taskId = cb.parentElement.getAttribute('id');
        if (localStorage.getItem(taskId) === 'true') {
          cb.checked = true;
          addPoints(parseInt(cb.getAttribute('data-points')));
          markCompleted(cb);
        }
        // æ·»åŠ äº‹ä»¶ç›‘å¬
        cb.addEventListener('change', () => {
          if (cb.checked) {
            addPoints(parseInt(cb.getAttribute('data-points')));
            markCompleted(cb);
            localStorage.setItem(taskId, 'true');
          } else {
            subtractPoints(parseInt(cb.getAttribute('data-points')));
            unmarkCompleted(cb);
            localStorage.setItem(taskId, 'false');
          }
          checkBadges();
          saveData();
          updateProgress();
        });
      });

      updateProgress();
    };

    function addPoints(points) {
      totalPoints += points;
      updatePoints();
    }

    function subtractPoints(points) {
      totalPoints -= points;
      if (totalPoints < 0) totalPoints = 0;
      updatePoints();
    }

    function updatePoints() {
      totalPointsEl.textContent = totalPoints;
    }

    function markCompleted(checkbox) {
      checkbox.parentElement.classList.add('completed');
    }

    function unmarkCompleted(checkbox) {
      checkbox.parentElement.classList.remove('completed');
    }

    function checkBadges() {
      for (const badge in badges) {
        if (totalPoints >= badges[badge].required && !unlockedBadges.includes(badge)) {
          unlockedBadges.push(badge);
          updateBadges();
        }
      }
    }

    function updateBadges() {
      badgesEl.innerHTML = unlockedBadges.map(b => `<span>${b}</span>`).join('');
    }

    function saveData() {
      localStorage.setItem('totalPoints', totalPoints);
      localStorage.setItem('unlockedBadges', JSON.stringify(unlockedBadges));
    }

    function updateProgress() {
      const totalTasks = checkboxes.length;
      const completedTasks = document.querySelectorAll('input[type="checkbox"]:checked').length;
      const progressPercent = Math.round((completedTasks / totalTasks) * 100);
      progressEl.style.width = `${progressPercent}%`;
      progressEl.textContent = `${progressPercent}%`;
    }

    // è¯»å–ç§¯åˆ†å’Œå¾½ç« æ•°æ®ä»ä»»åŠ¡åˆ—è¡¨
    document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
      const pointsMatch = cb.parentElement.textContent.match(/<!--\s*points:(\d+)\s*-->/);
      if (pointsMatch) {
        cb.setAttribute('data-points', pointsMatch[1]);
      }
    });
  </script>
</body>
</html>
